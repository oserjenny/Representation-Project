---
title: "Data cleaning"
author: "Jenny"
date: "January 2019"
output:
  github_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(readr)
library(tidyverse)
library(knitr)
```

## Introduction

This file documents the data cleaning for the Representation Project

## Data cleaning

Read in the data.
```{r}
tbl<-read_rds("../Data/cumulative_2006_2017.Rds")
```

Take a look at the data
```{r} 
head(tbl)
```

Look at all variable names in file
```{r} 
names(tbl)
```

Select variables (from Kuriwaki Guide)
```{r}
tbl %>%
  select(year, case_id, pid3)
```


Display frequencies of validated turnout General Election over time - shows only first few rows in console
```{r} 
tbl %>% 
  group_by (year) %>% 
  count (vv_turnout_gvm) 
```

Display frequencies of validated turnout General Election over time - shows all rows in console
```{r} 
tbl %>% 
  group_by (year) %>% 
  count (vv_turnout_gvm) %>% 
  as.data.frame
```

Recode of vv_turnout_gvm to dichotomous
```{r} 
tbl <- tbl %>%
  mutate(vv_turnout_gvm_binary=as.numeric(vv_turnout_gvm=="Voted"))
```

Display frequencies of recoded Validated turnout General Election over time 
```{r} 
tbl %>% 
  group_by (year) %>% 
  count (vv_turnout_gvm_binary) 
```

Display table, frequencies of recoded Validated turnout General Election over time 
```{r} 
tbl %>% 
  group_by (year) %>% 
  count (vv_turnout_gvm_binary) %>% 
  kable(align=c("l","c","c"))
```


JO exploring additional vars in dataset
Year
```{r} 
tbl %>% 
  count (year) 
```

tookpost - "Whether or not the respondent took the post-election wave of the survey (in even years)"
```{r} 
tbl %>% 
  group_by(year) %>% 
  count(tookpost) 
```

Weight - year-specific for all years, see Kuriwaki p.7 for notes
```{r} 
tbl %>% 
  group_by(year) %>% 
  count(weight) 
```

Weight - cumulative. Includes simple adjustment of multiplying a constant within year to make years comparable.
```{r} 
tbl %>% 
  group_by(year) %>% 
  count(weight_cumulative) 
```

Geographic variables
*State - imputed from input zipcode
```{r} 
tbl %>% 
  count(state) 
```

Geographic variables
*St - same data as "State", Var name = 2-letter State abbreviation
```{r} 
tbl %>% 
  count(st) 
```

Geographic variables
*cd: Congressional district in current Congress
```{r} 
tbl %>% 
  count(state) 
```

Gender
```{r} 
tbl %>% 
  count(gender) 
```

Age
```{r} 
tbl %>% 
  count(age) 
```

ggplot attempts
Plot turnout dichotomous by year
```{r} 
ggplot(tbl,aes(x=year,y=vv_turnout_gvm_binary))

```

Revising attempt w JA 29Jan version 1
```{r} 
ggplot(tbl,aes(x=year,y=vv_turnout_gvm_binary))+
  geom_bar(aes(y=..count..))

```

Revising attempt w JA 29Jan version 2
```{r} 
tbl %>% 
  group_by(year) %>% 
  summarise(Proportion=mean(vv_turnout_gvm_binary,na.omit=TRUE)) %>% 
  filter(!is.na(Proportion)) %>% 
  ggplot(aes(x=as.factor(year),y=Proportion))+
  geom_bar(stat="identity") +
  labs(x="Year")

```


JO attempted new coding based on Grolemund & Wickham - nope
```{r} 
ggplot(data = tbl)
 geom_point(mapping = aes(x=year,y=vv_turnout_gvm_binary))
```


JO attempted new coding based on Grolemund & Wickham - nope
```{r} 
ggplot(tbl, geom_point(mapping = aes(x=year, y=vv_turnout_gvm_binary)))
```

JO attempted new coding based on Grolemund & Wickham - nope
```{r} 
ggplot(data = tbl, mapping = aes(x=year, y=vv_turnout_gvm_binary)) 
geom_point()
```

JO attempted new coding based on Grolemund & Wickham - nope
```{r} 
ggplot(tbl, aes(x=year, y=vv_turnout_gvm_binary)) 
geom_point
```

JO attempted new coding based on Grolemund & Wickham - nope
```{r} 
ggplot(tbl)
geom_point(mapping = aes(x=year, y=vv_turnout_gvm_binary))

```




